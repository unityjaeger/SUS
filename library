local lib = {
    waitstyle = "RenderStepped"
    fps = 0;
}

local funcs = {}
game:GetService("RunService").RenderStepped:Connect(function(delta)
    lib.fps = delta
    for _, Function in pairs(funcs) do
        Function()
    end
end)

function lib:GUIDName(name)
    return name.."_"..game:GetService("HTTPService"):GenerateGUID(true)
end

function lib:AddToRender(name, func)
    funcs[name] = func
end

function lib:RemoveFromRender(name)
    if funcs[name] then
        funcs[name]:Disconnect()
        funcs[name] = nil
    end
end

lib:AddToRender("fps_updater_intern", function(delta)
    lib.fps = delta
    print(delta)
end)

function lib:DictSize(dictionary, element)
    local n = 0
    for k,_ in pairs(dictionary) do
        if element then
            if k == element then
                n = n + 1
            end
        else
            n = n + 1
        end
    end
    return n
end

function lib:Player()
    return game:GetService("Players").LocalPlayer or nil
end

function lib:Character(var)
    if lib:Player() and lib:Player().Character then
        if var then
            return lib:Player().Character:FindFirstChild(var) or nil
        else
            return lib:Player().Character
        end
    end
end

function lib:Humanoid(alive, OnExist)
    local hum = lib:Character("Humanoid")
    if not hum then return end

    if not alive then
        if OnExist then
            OnExist()
        end
        return hum
    else
        if hum.Health > 0 then
            if OnExist then
                OnExist()
            end
            return hum
        end
    end
end

function lib:Root(OnExist)
    return lib:Character("HumanoidRootPart")
end


function lib:WaitFor(parent, var, timeout, OnExist)
    local stopat = os.clock() + (timeout or 30)

    while not parent:FindFirstChild(var) do
        if os.clock() >= stopat then
            break
        end

        game:GetService("RunService")[lib.waitstyle]:Wait()
    end

    if parent:FindFirstChild(var) then
        return parent[var]
    else
        return nil
    end
end

return lib
